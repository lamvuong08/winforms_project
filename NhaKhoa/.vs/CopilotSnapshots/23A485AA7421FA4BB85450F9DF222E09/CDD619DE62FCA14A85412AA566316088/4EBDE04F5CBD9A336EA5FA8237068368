using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using NhaKhoa.TaiKhoan;

namespace NhaKhoa
{
    public partial class frmMain : Form
    {
        private Form currentSubForm = null;

        public frmMain()
        {
            InitializeComponent();
            UC_Menu menu = new UC_Menu();
            menu.Dock = DockStyle.Left;
            menu.MenuItemClicked += UC_Menu_MenuItemClicked;
            this.Controls.Add(menu);
        }

        //Mở form con với quản lý trạng thái
        private void OpenSubForm(Form subForm)
        {
            //Nếu form cũ tồn tại, đóng nó
            if (currentSubForm != null && !currentSubForm.IsDisposed)
            {
                currentSubForm.Close();
                currentSubForm.Dispose();
            }

            //Lưu form mới
            currentSubForm = subForm;
            currentSubForm.ShowDialog();

            //Sau khi form đóng
            currentSubForm.Dispose();
            currentSubForm = null;
        }

        //Xử lý sự kiện menu
        private void UC_Menu_MenuItemClicked(object sender, MenuItemEventArgs e)
        {
            switch (e.MenuItem)
            {
                case "Taikhoan":
                    OpenSubForm(new FRM_Account());
                    break;
                case "Benhnhan":
                    //OpenSubForm(new frmBenhNhan());
                    break;
                case "Nhanvien":
                    //OpenSubForm(new frmNhanVien());
                    break;
                case "Vatlieu":
                    //OpenSubForm(new frmVatLieu());
                    break;
                case "Thuoc":
                    //OpenSubForm(new frmThuoc());
                    break;
                case "Hoadon":
                    //OpenSubForm(new frmHoaDon());
                    break;
                case "Doanhthu":
                    //OpenSubForm(new frmDoanhThu());
                    break;
                case "Datlich":
                    OpenSubForm(new frmDatlich());
                    break;
            }
        }

        //Form đặt lịch
        private void mnuDatlich_Click(object sender, EventArgs e)
        {
            OpenSubForm(new frmDatlich());
        }
    }
}
